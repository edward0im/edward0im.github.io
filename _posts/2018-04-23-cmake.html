---
layout: post
title: cmake 
description: 
date: 2018-04-23
categories: [Computer Science]
use_math: true
comments: true
---
<div id="outline-container-orgc1603cd" class="outline-2">
<h2 id="orgc1603cd">Commands</h2>
<div class="outline-text-2" id="text-orgc1603cd">
</div>
<div id="outline-container-org3abb2ad" class="outline-3">
<h3 id="org3abb2ad">CMAKE\<sub>MINIMUM</sub>\<sub>REQUIRED</sub>()</h3>
<div class="outline-text-3" id="text-org3abb2ad">
<ul class="org-ul">
<li>필요 CMake 최소 버전 명시</li>
</ul>
</div>
</div>
<div id="outline-container-org4ee3945" class="outline-3">
<h3 id="org4ee3945">PROJECT()</h3>
<div class="outline-text-3" id="text-org4ee3945">
<ul class="org-ul">
<li>프로젝트 이름 설정</li>
</ul>
</div>
</div>
<div id="outline-container-orgf527e74" class="outline-3">
<h3 id="orgf527e74">MESSAGE()</h3>
<div class="outline-text-3" id="text-orgf527e74">
<ul class="org-ul">
<li>콘솔에 메세지 출력</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ MESSAGE ( [&lt;Type&gt;] &lt;&#47700;&#49884;&#51648;&gt; )
ex: $ MESSAGE ( FATAL_ERROR <span style="color: #2aa198;">"Fatal error occurred!"</span> )
</pre>
</div>
<ul class="org-ul">
<li>Type은 다음중 하나이며, 생략할 수 있습니다.
<ul class="org-ul">
<li>STATUS : 상태 메시지 출력 (메시지 앞에 '&#x2013;'가 추가되서 출력됨)</li>
<li>WARNING : 경고 메시지를 출력하고, 계속 진행</li>
<li>AUTHOR\<sub>WARNING</sub> : 프로젝트 개발자용 경고 메시지를 출력하고, 계속 진행</li>
<li>SEND\<sub>ERROR</sub> : 오류 메시지를 출력하고 계속 진행하지만, Makefile 생성은 하지 않음</li>
<li>FATAL\<sub>ERROR</sub> : 오류 메시지를 출력하고, 작업을 즉시 중단</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org730716c" class="outline-3">
<h3 id="org730716c">ADD\<sub>EXECUTABLE</sub>()</h3>
<div class="outline-text-3" id="text-org730716c">
<ul class="org-ul">
<li>빌드 최종 결과물로 생성할 실행 파일을 추가합니다. 이 명령을 반복하여 생성할 실행 파일을 계속 추가할 수 있습니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ ADD<span style="color: #2aa198;">\_</span>EXECUTABLE ( app.out main.c foo.c bar.c )
</pre>
</div>
</div>
</div>

<div id="outline-container-org90db1c4" class="outline-3">
<h3 id="org90db1c4">ADD\<sub>LIBRARY</sub>()</h3>
<div class="outline-text-3" id="text-org90db1c4">
<ul class="org-ul">
<li>빌드 최종 결과물로 생성할 라이브러리를 추가합니다. 이 명령을 반복하여 생성할 라이브러리를 계속 추가할 수 있습니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ ADD<span style="color: #2aa198;">\_</span>LIBRARY ( &lt;&#46972;&#51060;&#48652;&#47084;&#47532;<span style="color: #2aa198;">\_</span>&#51060;&#47492;&gt; [STATIC|SHARED|MODULE] &lt;&#49548;&#49828;<span style="color: #2aa198;">\_</span>&#54028;&#51068;&gt; &lt;&#49548;&#49828;<span style="color: #2aa198;">\_</span>&#54028;&#51068;&gt; ... )
ex: $ ADD<span style="color: #2aa198;">\_</span>LIBRARY ( app STATIC foo.c bar.c )
</pre>
</div>
<ul class="org-ul">
<li>&lt;라이브러리\<sub>이름</sub>&gt; : 생성할 라이브러리 이름 (lib~.a / lib~.so 에서 ~에 들어갈 값)</li>
<li>[STATIC|SHARED|MODULE] : 라이브러리 종류 (생략시 STATIC)</li>
<li>&lt;소스\<sub>파일</sub>&gt; : 라이브러리를 생성하는 데 필요한 소스 파일</li>
</ul>
</div>
</div>

<div id="outline-container-orga6291d0" class="outline-3">
<h3 id="orga6291d0">ADD\<sub>CUSTOM</sub>\<sub>TARGET</sub>()</h3>
<div class="outline-text-3" id="text-orga6291d0">
<ul class="org-ul">
<li>사용자 정의 Target 추가</li>
<li>통상적인 빌드 절차로 생성할 수 없는 Target을 추가합니다.. 라지만, 실상은 make 매크로를 정의할 때 더 많이 사용합니다.(make flash 라던가.)</li>
<li>Taget의 Recipe를 직접 지정해야 하는 경우 유용하게 활용할 수 있습니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ ADD<span style="color: #2aa198;">\_</span>CUSTOM<span style="color: #2aa198;">\_</span>TARGET (
                &lt;&#51060;&#47492;&gt; [ALL]
                [COMMENT &lt;&#52636;&#47141;<span style="color: #2aa198;">\_</span>&#47700;&#49884;&#51648;&gt;]
                [DEPENDS &lt;&#51032;&#51316;<span style="color: #2aa198;">\_</span>&#45824;&#49345;<span style="color: #2aa198;">\_</span>&#47785;&#47197;&gt;]
                [WORKING<span style="color: #2aa198;">\_</span>DIRECTORY &lt;&#51089;&#50629;<span style="color: #2aa198;">\_</span>&#46356;&#47113;&#53664;&#47532;&gt;]
                COMMAND &lt;&#47749;&#47161;&gt;
                [COMMAND &lt;&#47749;&#47161;&gt;]
                ...
)

ex:
$ ADD<span style="color: #2aa198;">\_</span>CUSTOM<span style="color: #2aa198;">\_</span>TARGET ( flash
        COMMENT <span style="color: #2aa198;">"Flashing binary"</span>
        WORKING<span style="color: #2aa198;">\_</span>DIRECTORY ${<span style="color: #268bd2;">CMAKE</span><span style="color: #2aa198;">\_</span>RUNTIME<span style="color: #2aa198;">\_</span>OUTPUT<span style="color: #2aa198;">\_</span>DIRECTORY}
        COMMAND python esptool.py write<span style="color: #2aa198;">\_</span>flash app.bin
        DEPENDS app.out
        )
</pre>
</div>
</div>
</div>

<div id="outline-container-org01e1e18" class="outline-3">
<h3 id="org01e1e18">ADD\<sub>DEPENDENCIES</sub>()</h3>
<div class="outline-text-3" id="text-org01e1e18">
<ul class="org-ul">
<li>Top-level Target간의 의존성을 지정합니다. Top-level Target이란 ADD\<sub>EXECUTABLE</sub>, ADD\<sub>LIBRARY</sub>, ADD\<sub>CUSTOM</sub>\<sub>TARGET</sub> 명령으로 정의한 Target들을 의미합니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ ADD<span style="color: #2aa198;">\_</span>DEPENDENCIES ( &lt;Target<span style="color: #2aa198;">\_</span>&#51060;&#47492;&gt; &lt;&#51032;&#51316;<span style="color: #2aa198;">\_</span>&#45824;&#49345;&gt; &lt;&#51032;&#51316;<span style="color: #2aa198;">\_</span>&#45824;&#49345;&gt; ... )
$ ADD<span style="color: #2aa198;">\_</span>DEPENDENCIES ( flash app.out )
</pre>
</div>
</div>
</div>

<div id="outline-container-org484fb25" class="outline-3">
<h3 id="org484fb25">INSTALL()</h3>
<div class="outline-text-3" id="text-org484fb25">
<ul class="org-ul">
<li>Makefile에서 관용적으로 설치용 Target으로 사용되는 install target의 동작 방식을 정의합니다. 즉, <b>make install</b> 명령을 실행했을 때 무슨 동작을 수행할지를 지정합니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ INSTALL ( TARGETS &lt;Target<span style="color: #2aa198;">\_</span>&#47785;&#47197;&gt;
        RUNTIME DESTINATION &lt;&#48148;&#51060;&#45320;&#47532;<span style="color: #2aa198;">\_</span>&#49444;&#52824;<span style="color: #2aa198;">\_</span>&#44221;&#47196;&gt;
        LIBRARY DESTINATION &lt;&#46972;&#51060;&#48652;&#47084;&#47532;<span style="color: #2aa198;">\_</span>&#49444;&#52824;<span style="color: #2aa198;">\_</span>&#44221;&#47196;&gt;
        ARCHIVE DESTINATION &lt;&#50500;&#52852;&#51060;&#48652;<span style="color: #2aa198;">\_</span>&#49444;&#52824;<span style="color: #2aa198;">\_</span>&#44221;&#47196;&gt;
        )

ex: $ INSTALL ( TARGETS app.out app
        RUNTIME<span style="color: #2aa198;">\_</span>DESTINATION /usr/local/bin
        ARCHIVE<span style="color: #2aa198;">\_</span>DESTINATION /usr/local/lib
        )
&#50696;: &#50948; &#47749;&#47161;&#51008; app.out&#51008; /usr/local/bin&#50640;, libapp.a&#45716; /usr/local/lib&#50640; &#49444;&#52824;&#54616;&#45716; install target&#51012; &#52628;&#44032;&#54633;&#45768;&#45796;.
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org96f909f" class="outline-2">
<h2 id="org96f909f">Variables</h2>
<div class="outline-text-2" id="text-org96f909f">
<ul class="org-ul">
<li>변수를 설정하는 방법은 <b>set($VARIABLE value)</b> 로 설정할 수 있다</li>
<li>변수를 확인하는 방법은 <b>message(${VARIABLE})</b> 로 확인할 수 있다</li>
</ul>
</div>
<div id="outline-container-orgf858630" class="outline-3">
<h3 id="orgf858630">${CMAKE\<sub>PROJECT</sub>\<sub>NAME</sub>}</h3>
<div class="outline-text-3" id="text-orgf858630">
<ul class="org-ul">
<li>프로젝트 이름</li>
</ul>
</div>
</div>

<div id="outline-container-org4288768" class="outline-3">
<h3 id="org4288768">${CMAKE\<sub>BUILD</sub>\<sub>TYPE</sub>}</h3>
<div class="outline-text-3" id="text-org4288768">
<ul class="org-ul">
<li>빌드 형상(Configuration)
<ul class="org-ul">
<li>Debug : 디버깅 목적의 빌드</li>
<li>Release : 배포 목적의 빌드</li>
<li>RelWithDebInfo : 배포 목적의 빌드지만, 디버깅 정보 포함</li>
<li>MinSizeRel : 최소 크기로 최적화한 배포 목적 빌드</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgf077a1b" class="outline-3">
<h3 id="orgf077a1b">${CMAKE\<sub>VERBOSE</sub>\<sub>MAKEFILE</sub>}</h3>
<div class="outline-text-3" id="text-orgf077a1b">
<ul class="org-ul">
<li>Verbose Makefile 작성 여부</li>
<li>이 변수는 Switch변수이며, 다음과 같이 값을 true(또는 1)로 지정하면 빌드 상세 과정을 모두 출력하는 Makefile을 생성합니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ SET ( CMAKE<span style="color: #2aa198;">\_</span>VERBOSE<span style="color: #2aa198;">\_</span>MAKEFILE true )
</pre>
</div>
</div>
</div>

<div id="outline-container-orga16c92a" class="outline-3">
<h3 id="orga16c92a">${CMAKE\<sub>INSTALL</sub>\<sub>PREFIX</sub>}</h3>
<div class="outline-text-3" id="text-orga16c92a">
<ul class="org-ul">
<li>설치 매크로(make install)에서 실행 바이너리와 라이브러리 등의 최종 생성물을 복사할 설치 디렉토리를 지정합니다. INSTALL() 명령에서 상대 경로를 사용한 경우, 이 변수에 지정한 디렉토리가 Base 디렉토리가 됩니다.</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">$ SET ( CMAKE<span style="color: #2aa198;">\_</span>INSTALL<span style="color: #2aa198;">\_</span>PREFIX /usr/bin )
</pre>
</div>
<ul class="org-ul">
<li>이 변수를 별도로 지정하지 않으면 기본값은 <b>/usr/local</b> 입니다.</li>
</ul>
</div>
</div>
</div>
